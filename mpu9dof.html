<!DOCTYPE html>
<html class="no-js" lang="en">
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>MPU9DOF Click Support</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="icon" href="favicon.ico">

</head>

<body class="ss-bg-white">

    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-fade">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <div id="top" class="s-wrap site-wrapper">

        <!-- site header
        ================================================== -->
        <header class="s-header header">

            <div class="header__top">
                    <div class="header__logo">
                            <a>   GSoC '19 Project : Click Board Support Under Greybus <br> <br>                     
                           </a>
                           <a><strong>under Beagleboard.org Foundation</strong></a>
       
                       </div>

               
                <a href="#0" class="header__menu-toggle"><span>Menu</span></a>

            </div>

            <nav class="header__nav-wrap">

                        <ul class="header__nav">
                                <li ><a href="index.html" title="">Home</a></li>                
                                <li class="current"><a href="index.html" title="">Blog</a></li>
                                <li><a href="about.html" title="">About</a></li>
                                <li><a href="contact.html" title="">Contact</a></li>
                        </ul> <!-- end header__nav -->

            
            </nav> <!-- end header__nav-wrap -->

        </header> <!-- end s-header -->


        <!-- site content
        ================================================== -->
        <div class="s-content content">
            <main class="row content__page">
                
                <article class="column large-full entry format-standard">

                    <div class="media-wrap entry__media">
                        <div class="entry__post-thumb">
                            <img src="images/post/mpu9dof.jpg" alt="">
                        </div>
                    </div>

                    <div class="content__page-header entry__header">
                        <h1 class="display-1 entry__title">
                        MPU9DOF Click Support
                        </h1>
                        <ul class="entry__header-meta">
                            <li class="author">By <a href="#0">Vaishnav M A</a></li>
                            <li class="date">August 05, 2019</li>
                            <li class="cat-links">
                                <a href="#0">Clicks</a>
                            </li>
                        </ul>
                    </div> <!-- end entry__header -->

                    <div class="entry__content">

                        <p class="lead drop-cap">
                        This post contains the information about setting up and interfacing the MikroElektronika MPU9DOF Click with PocketBeagle and 
                        Beaglebone Black, This post assumes that GBSIM is correctly installed and setup in your board.MPU 9DOF click carries the MPU–9250 System in Package, which is the world’s first 9-axis Motion Tracking device. MPU–9250 comprises two chips. One is the MPU–6050 that contains a 3-axis accelerometer, a 3-axis gyroscope, and a DMP (digital motion processor); the other is AK8975, a 3-axis digital compass. It is designed for the low power, low cost, and high-performance requirements of consumer electronics equipment and wearable sensors. 
                        <h3>Start GBSIM</h3>
    
                        <p> Before inserting the click manifest start gbsim wither using the start script or by separately modprobe the modules and running gbsim.</p>

<pre><code>sudo sh startgbsim.sh</code></pre>

<h3>Insert the Click Manifest using the CLI</h3>
<p>Clone and setup the insclick CLI along with the manifesto tool and create the manifest blobs</p>

<pre><code>git clone https://github.com/vaishnav98/manifesto.git
 cd manifesto
./manifesto -o manifests/i2c1.mnfb manifests/i2c1.mnfs
./manifesto -o manifests/gpio.mnfb manifests/gpio.mnfs
./manifesto -o manifests/i2c2.mnfb manifests/i2c2.mnfs
sudo cp manifests/i2c1.mnfb /tmp/gbsim/hotplug-module/
sudo cp manifests/gpio.mnfb /tmp/gbsim/hotplug-module/</code></pre>

<h3>Clone and Compile the Mikrobus Kernel Module</h3>
<p>Clone and setup the  Mikrobus Kernel Module , connect the click to the corresponding slot and instantiate the mpu9dof click on the greybus i2c bus</p>

<pre><code>git clone https://github.com/vaishnav98/mikrobus_device.git
 cd mikrobus_device
 make -C /usr/src/linux-headers-4.14.108-ti-r108/ M=$PWD
 sudo insmod mikrobus.ko
 sudo insmod mikrobus_i2c_device.ko name=mpu9dof port=PBP1</code></pre>

<h3>Output</h3>

The dmesg log output should be similar to this: 
<img src="images/post/mpudmesg.JPG" alt="">
<p>A new device will be created at /sys/bus/iio/devices/ if the click was loaded correctly, the imu readings can be read using the following commands:

</p>

<pre><code>cat /sys/bus/iio/devices/iio\:device1/in_accel_x_raw
cat /sys/bus/iio/devices/iio\:device1/in_accel_y_raw
cat /sys/bus/iio/devices/iio\:device1/in_accel_z_raw
cat /sys/bus/iio/devices/iio\:device1/in_anglvel_x_raw
cat /sys/bus/iio/devices/iio\:device1/in_anglvel_y_raw
cat /sys/bus/iio/devices/iio\:device1/in_anglvel_z_raw
cat /sys/bus/iio/devices/iio\:device1/in_temp_raw</code></pre>

The output should be similar to this: 
<img src="images/post/mpuout.JPG" alt="">

</div> <!-- end entry content -->
                </article> <!-- end column large-full entry-->
           
            </main>

        </div> <!-- end s-content -->


        <!-- footer
        ================================================== -->
        <footer class="s-footer footer">
            <div class="row">
                <div class="column large-full footer__content">
                   
                </div>
            </div>

            <div class="go-top">
                <a class="smoothscroll" title="Back to Top" href="#top"></a>
            </div>
        </footer>

    </div> <!-- end s-wrap -->


    <!-- Java Script
    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

</body>